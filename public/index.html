<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anpassa | Math Platform</title>
    
    <!-- React & Core Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Styling & Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .katex { font-size: 1.1em; } 
        
        .drawer-enter { transform: translateX(-100%); }
        .drawer-enter-active { transform: translateX(0); transition: transform 300ms; }
        .drawer-exit { transform: translateX(0); }
        .drawer-exit-active { transform: translateX(-100%); transition: transform 300ms; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CATEGORIES = {
            algebra: {
                label: { sv: "Algebra", en: "Algebra" },
                topics: [
                    { id: 'equation', label: { sv: "Ekvationer", en: "Equations" } },
                    { id: 'simplify', label: { sv: "FÃ¶renkling", en: "Simplification" } }
                ]
            },
            geometry: {
                label: { sv: "Geometri", en: "Geometry" },
                topics: [
                    { id: 'geometry', label: { sv: "Area & Omkrets", en: "Area & Perimeter" } },
                    { id: 'scale', label: { sv: "Skala", en: "Scale" } }
                ]
            },
            functions: {
                label: { sv: "Samband", en: "Functions" },
                topics: [
                    { id: 'graph', label: { sv: "RÃ¤ta Linjen", en: "Linear Graphs" } }
                ]
            }
        };

        const LEVEL_DESCRIPTIONS = {
            equation: {
                1: { sv: "Enstegsekvationer (ax = b)", en: "One-step equations (ax = b)" },
                2: { sv: "TvÃ¥stegsekvationer (ax + b = c)", en: "Two-step equations (ax + b = c)" },
                3: { sv: "Variabel pÃ¥ bÃ¥da sidor", en: "Variables on both sides" },
                4: { sv: "Parenteser och distribution", en: "Parentheses and distribution" },
                5: { sv: "Blandade svÃ¥rare problem", en: "Mixed complex problems" }
            },
            simplify: {
                1: { sv: "FÃ¶renkla termer (ax + b + cx)", en: "Combine like terms" },
                2: { sv: "Multiplicera in i parentes", en: "Distribute into parentheses" },
                3: { sv: "Distribuera och fÃ¶renkla", en: "Distribute and combine" },
                4: { sv: "Subtraktion av parenteser", en: "Subtracting parentheses" },
                5: { sv: "Blandade uttryck", en: "Mixed expressions" }
            },
            geometry: {
                1: { sv: "Omkrets (Rektangel)", en: "Perimeter (Rectangle)" },
                2: { sv: "Area (Rektangel)", en: "Area (Rectangle)" },
                3: { sv: "Area (Triangel)", en: "Area (Triangle)" },
                4: { sv: "Omkrets (Cirkel)", en: "Circumference (Circle)" },
                5: { sv: "Sammansatta figurer", en: "Composite shapes" }
            },
            scale: {
                1: { sv: "Hitta verklig lÃ¤ngd (Visuellt)", en: "Find real length (Visual)" },
                2: { sv: "Hitta bildens lÃ¤ngd (Visuellt)", en: "Find drawing length (Visual)" },
                3: { sv: "BerÃ¤kna skalan", en: "Calculate the scale" },
                4: { sv: "Textuppgifter (Utan bild)", en: "Word problems (No image)" },
                5: { sv: "Blandade problem", en: "Mixed problems" }
            },
            graph: {
                1: { sv: "Hitta m-vÃ¤rdet (Intercept)", en: "Find y-intercept (m)" },
                2: { sv: "Hitta k-vÃ¤rdet (Positivt)", en: "Find slope (Positive)" },
                3: { sv: "Hitta k-vÃ¤rdet (Negativt)", en: "Find slope (Negative)" },
                4: { sv: "BestÃ¤m funktionen (y=kx+m)", en: "Find equation (y=kx+m)" },
                5: { sv: "Blandade grafer", en: "Mixed graphs" }
            }
        };

        const UI_TEXT = {
            sv: {
                streak: "Streak",
                loading: "Laddar frÃ¥ga...",
                error: "Kunde inte ladda frÃ¥gan.",
                help: "Visa ledtrÃ¥dar",
                hideHelp: "DÃ¶lj ledtrÃ¥dar",
                submit: "Svara",
                correct: "RÃ¤tt! NÃ¤sta...",
                incorrect: "Inte riktigt, fÃ¶rsÃ¶k igen",
                placeholder: "Skriv ditt svar...",
                level: "NivÃ¥",
                history: "Historik",
                noHistory: "Inga svar Ã¤n.",
                clueUsed: "HjÃ¤lp anvÃ¤nd"
            },
            en: {
                streak: "Streak",
                loading: "Loading question...",
                error: "Could not load question.",
                help: "Show Clues",
                hideHelp: "Hide Clues",
                submit: "Submit",
                correct: "Correct! Next...",
                incorrect: "Not quite, try again",
                placeholder: "Enter your answer...",
                level: "Level",
                history: "History",
                noHistory: "No answers yet.",
                clueUsed: "Clue used"
            }
        };

        const MathText = ({ text, className = "", large = false }) => {
            if (!text) return null;
            const parts = text.split(/(\$[^\$]+\$)/g);
            return (
                <span className={className}>
                    {parts.map((part, index) => {
                        if (part.startsWith('$') && part.endsWith('$')) {
                            const tex = part.slice(1, -1);
                            try {
                                const html = katex.renderToString(tex, { throwOnError: false, displayMode: large });
                                return <span key={index} dangerouslySetInnerHTML={{ __html: html }} />;
                            } catch (e) { return <span key={index} className="text-red-500">{part}</span>; }
                        }
                        return <span key={index}>{part}</span>;
                    })}
                </span>
            );
        };

        const GraphCanvas = ({ data }) => {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas || !data) return;
                const ctx = canvas.getContext('2d');
                const width = canvas.width; const height = canvas.height;
                const range = data.range || 10;
                ctx.clearRect(0, 0, width, height);
                const toX = (val) => (val + range) * (width / (range * 2));
                const toY = (val) => height - (val + range) * (height / (range * 2));

                ctx.strokeStyle = '#e5e7eb'; ctx.lineWidth = 1;
                for (let i = -range; i <= range; i += data.gridStep || 1) {
                    ctx.beginPath(); ctx.moveTo(toX(i), 0); ctx.lineTo(toX(i), height); ctx.stroke();
                    ctx.beginPath(); ctx.moveTo(0, toY(i)); ctx.lineTo(width, toY(i)); ctx.stroke();
                }
                ctx.strokeStyle = '#374151'; ctx.lineWidth = 2;
                ctx.beginPath(); ctx.moveTo(toX(0), 0); ctx.lineTo(toX(0), height); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(0, toY(0)); ctx.lineTo(width, toY(0)); ctx.stroke();
                
                data.lines.forEach(line => {
                    ctx.strokeStyle = line.color || '#dc2626'; ctx.lineWidth = 3;
                    ctx.beginPath();
                    const x1 = -range; const y1 = line.slope * x1 + line.intercept;
                    const x2 = range; const y2 = line.slope * x2 + line.intercept;
                    ctx.moveTo(toX(x1), toY(y1)); ctx.lineTo(toX(x2), toY(y2)); ctx.stroke();
                });
            }, [data]);
            return <div className="flex justify-center my-4"><canvas ref={canvasRef} width={300} height={300} className="bg-white rounded border border-gray-300 shadow-sm" /></div>;
        };

        // NEW: Robust Geometry Visualizer with Labels
        const GeometryVisual = ({ data }) => {
            if (!data) return null;

            // Handle Scale Generator Types (Legacy/Specific logic)
            if (data.type === 'scale_single' || data.type === 'scale_compare') {
                const ShapeIcon = ({ size }) => (
                     <div className={`border-2 border-indigo-500 bg-indigo-50 flex items-center justify-center text-xs text-indigo-700 font-bold shadow-sm rounded`} 
                        style={{ width: size, height: size }}>{data.shape || 'Box'}</div>
                );
                if (data.type === 'scale_single') {
                    return <div className="flex flex-col items-center gap-2 my-4"><ShapeIcon size="80px" /><span className="bg-white px-3 py-1 rounded shadow text-sm font-mono border border-gray-200">{data.label}</span></div>;
                }
                if (data.type === 'scale_compare') {
                    return (
                        <div className="flex items-end justify-center gap-4 sm:gap-8 my-6">
                            <div className="flex flex-col items-center gap-2"><span className="text-xs font-bold uppercase text-gray-400 mb-1">{data.leftLabel}</span><ShapeIcon size="50px" /><span className="text-sm font-mono bg-white px-2 rounded border mt-2">{data.leftValue}</span></div>
                            <div className="pb-8 text-gray-300 text-2xl">â†’</div>
                            <div className="flex flex-col items-center gap-2"><span className="text-xs font-bold uppercase text-gray-400 mb-1">{data.rightLabel}</span><ShapeIcon size="100px" /><span className="text-sm font-mono bg-white px-2 rounded border mt-2">{data.rightValue}</span></div>
                        </div>
                    );
                }
            }

            // --- SVG RENDERER FOR GEOMETRY ---
            // Viewport 200x200
            
            if (data.type === 'rectangle') {
                // Normalize sizes to fit in 160x160 box with padding
                const maxDim = Math.max(data.width, data.height);
                const scale = 140 / maxDim;
                const w = data.width * scale;
                const h = data.height * scale;
                const x = (200 - w) / 2;
                const y = (200 - h) / 2;

                return (
                    <svg width="200" height="200" className="my-4">
                        <rect x={x} y={y} width={w} height={h} fill="#e0e7ff" stroke="#4f46e5" strokeWidth="3" />
                        {/* Bottom Label */}
                        <text x={100} y={y + h + 20} textAnchor="middle" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.bottom}</text>
                        {/* Right Label */}
                        <text x={x + w + 10} y={100} textAnchor="start" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.right}</text>
                    </svg>
                );
            }

            if (data.type === 'triangle') {
                // Isosceles representation for generic area problems
                const maxDim = Math.max(data.width, data.height); // width is base
                const scale = 140 / maxDim;
                const b = data.width * scale;
                const h = data.height * scale;
                const x = (200 - b) / 2;
                const baseY = 170;
                const topY = baseY - h;

                return (
                    <svg width="200" height="200" className="my-4">
                        <polygon points={`${x},${baseY} ${x + b},${baseY} ${100},${topY}`} fill="#e0e7ff" stroke="#4f46e5" strokeWidth="3" />
                        {/* Height Line (Dotted) */}
                        <line x1="100" y1={topY} x2="100" y2={baseY} stroke="#6b7280" strokeWidth="2" strokeDasharray="4" />
                        {/* Base Label */}
                        <text x={100} y={baseY + 20} textAnchor="middle" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.bottom}</text>
                        {/* Height Label */}
                        <text x={105} y={baseY - h/2} textAnchor="start" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.height}</text>
                    </svg>
                );
            }

            if (data.type === 'circle') {
                return (
                    <svg width="200" height="200" className="my-4">
                        <circle cx="100" cy="100" r="70" fill="#e0e7ff" stroke="#4f46e5" strokeWidth="3" />
                        {/* Radius Line */}
                        <line x1="100" y1="100" x2="170" y2="100" stroke="#374151" strokeWidth="2" />
                        {/* Radius Label */}
                        <text x={135} y={90} textAnchor="middle" fill="#374151" fontSize="14" fontWeight="bold">r = {data.labels.radius}</text>
                    </svg>
                );
            }

            if (data.type === 'composite') {
                // Ice Cream Cone
                // Top semi circle, bottom triangle
                // Simplified drawing logic
                return (
                    <svg width="200" height="200" className="my-4">
                        {/* Triangle Bottom */}
                        <polygon points="50,70 150,70 100,190" fill="#e0e7ff" stroke="#4f46e5" strokeWidth="3" />
                        {/* Semi Circle Top */}
                        <path d="M 50 70 A 50 50 0 0 1 150 70" fill="#e0e7ff" stroke="#4f46e5" strokeWidth="3" />
                        {/* Dotted Line for Diameter */}
                        <line x1="50" y1="70" x2="150" y2="70" stroke="#6b7280" strokeWidth="2" strokeDasharray="4" />
                        
                        {/* Labels */}
                        <text x={100} y={60} textAnchor="middle" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.top}</text>
                        <text x={140} y={130} textAnchor="start" fill="#374151" fontSize="14" fontWeight="bold">{data.labels.side}</text>
                    </svg>
                );
            }

            return null;
        };

        const HistoryDrawer = ({ history, isOpen, onClose, ui }) => {
            return (
                <>
                    {isOpen && <div className="fixed inset-0 bg-black/20 z-40 backdrop-blur-sm lg:hidden" onClick={onClose}></div>}
                    <div className={`fixed inset-y-0 left-0 w-80 bg-white shadow-2xl transform transition-transform duration-300 z-50 flex flex-col ${isOpen ? 'translate-x-0' : '-translate-x-full'}`}>
                        <div className="p-4 border-b flex justify-between items-center bg-gray-50">
                            <h2 className="font-bold text-gray-700">{ui.history}</h2>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600">âœ•</button>
                        </div>
                        <div className="flex-1 overflow-y-auto p-4 space-y-3">
                            {history.length === 0 ? <p className="text-gray-400 text-center text-sm py-4">{ui.noHistory}</p> : history.map((entry, i) => (
                                <div key={i} className={`p-3 rounded-lg border-l-4 text-sm ${entry.correct ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50'}`}>
                                    <div className="flex justify-between items-start mb-1">
                                        <span className="font-semibold capitalize text-gray-700">{entry.topic} <span className="text-xs font-normal text-gray-500">(Lvl {entry.level})</span></span>
                                        <span className="text-xs text-gray-400">{new Date(entry.time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                                    </div>
                                    <div className="text-gray-600 mb-1 line-clamp-2"><MathText text={entry.text} /></div>
                                    {entry.clueUsed && <span className="inline-block px-1.5 py-0.5 bg-yellow-100 text-yellow-700 text-[10px] rounded uppercase font-bold tracking-wider">{ui.clueUsed}</span>}
                                </div>
                            ))}
                        </div>
                    </div>
                </>
            );
        };

        const CluePanel = ({ clues, isVisible, ui }) => {
            if (!isVisible) return null;
            return (
                <div className="lg:w-80 w-full shrink-0 animate-fade-in">
                    <div className="bg-yellow-50 border border-yellow-200 rounded-xl p-5 shadow-sm sticky top-6">
                        <div className="flex items-center gap-2 mb-4 text-yellow-800 font-bold border-b border-yellow-200 pb-2"><span>ðŸ’¡ Hints</span></div>
                        <div className="space-y-6">
                            {clues.map((clue, i) => (
                                <div key={i} className="group">
                                    <div className="text-sm text-yellow-900 mb-2 font-medium leading-relaxed"><MathText text={clue.text} /></div>
                                    {clue.latex && <div className="bg-white p-3 rounded-lg border border-yellow-200 text-center shadow-sm overflow-x-auto"><MathText text={`$${clue.latex}$`} large={true} /></div>}
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        function App() {
            const [lang, setLang] = useState('sv'); 
            const [topic, setTopic] = useState('equation');
            const [level, setLevel] = useState(1);
            const [question, setQuestion] = useState(null);
            const [input, setInput] = useState('');
            const [feedback, setFeedback] = useState(null);
            const [loading, setLoading] = useState(false);
            const [streak, setStreak] = useState(0);
            const [history, setHistory] = useState([]);
            const [historyOpen, setHistoryOpen] = useState(false);
            const [cluesVisible, setCluesVisible] = useState(false);

            const ui = UI_TEXT[lang];

            const fetchQuestion = async (t = topic, l = level, lg = lang) => {
                setLoading(true); setFeedback(null); setInput(''); setCluesVisible(false);
                try {
                    const res = await fetch(`/api/question?topic=${t}&level=${l}&lang=${lg}`);
                    const data = await res.json();
                    if(data.error) throw new Error(data.error);
                    setQuestion(data);
                } catch(e) { console.error(e); setQuestion(null); } finally { setLoading(false); }
            };

            useEffect(() => { fetchQuestion(); }, []);

            const handleLangToggle = () => { const newLang = lang === 'sv' ? 'en' : 'sv'; setLang(newLang); fetchQuestion(topic, level, newLang); };
            const changeTopic = (newTopic) => { setTopic(newTopic); fetchQuestion(newTopic, level, lang); };
            const changeLevel = (newLevel) => { setLevel(newLevel); fetchQuestion(topic, newLevel, lang); };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!question || !input) return;
                const res = await fetch('/api/answer', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ answer: input, token: question.token })
                });
                const result = await res.json();
                setHistory(prev => [{ topic, level, correct: result.correct, text: question.renderData.description || question.renderData.latex, clueUsed: cluesVisible, time: Date.now() }, ...prev]);
                if (result.correct) {
                    setFeedback('correct'); setStreak(s => s + 1); setTimeout(() => fetchQuestion(topic, level, lang), 1500);
                } else {
                    setFeedback('incorrect'); setStreak(0);
                }
            };

            return (
                <div className="min-h-screen flex flex-col bg-gray-50">
                    <HistoryDrawer history={history} isOpen={historyOpen} onClose={() => setHistoryOpen(false)} ui={ui} />
                    <header className="sticky top-0 z-30 bg-white/80 backdrop-blur-md border-b border-gray-200 px-4 py-3 shadow-sm">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <button onClick={() => setHistoryOpen(true)} className="p-2 -ml-2 rounded-lg hover:bg-gray-100 text-gray-500">
                                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
                                </button>
                                <h1 className="text-xl font-bold text-indigo-700 tracking-tight hidden sm:block">Anpassa</h1>
                                <div className="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1"><span>ðŸ”¥</span> {streak}</div>
                            </div>
                            <button onClick={handleLangToggle} className="text-sm font-semibold text-gray-600 hover:text-indigo-600 transition-colors">{lang === 'sv' ? 'ðŸ‡¸ðŸ‡ª Svenska' : 'ðŸ‡¬ðŸ‡§ English'}</button>
                        </div>
                    </header>
                    <div className="flex-1 max-w-6xl mx-auto w-full p-4 sm:p-6 flex flex-col lg:flex-row gap-8 items-start">
                        <div className="flex-1 w-full min-w-0">
                            <nav className="bg-white rounded-xl shadow-sm border border-gray-100 p-4 mb-6">
                                <div className="flex flex-col gap-4">
                                    {Object.entries(CATEGORIES).map(([catKey, category]) => (
                                        <div key={catKey}>
                                            <h3 className="text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-2">{category.label[lang]}</h3>
                                            <div className="flex flex-wrap gap-2">
                                                {category.topics.map(t => (
                                                    <button key={t.id} onClick={() => changeTopic(t.id)} className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${topic === t.id ? 'bg-indigo-600 text-white shadow-md ring-2 ring-indigo-200' : 'bg-gray-50 text-gray-600 hover:bg-gray-100 hover:text-indigo-600'}`}>{t.label[lang]}</button>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </nav>
                            <div className="mb-6">
                                <div className="relative">
                                    <select value={level} onChange={(e) => changeLevel(Number(e.target.value))} className="w-full p-4 pl-12 bg-white border border-gray-200 rounded-xl text-gray-700 font-medium focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none shadow-sm cursor-pointer">
                                        {[1, 2, 3, 4, 5].map(l => { const desc = LEVEL_DESCRIPTIONS[topic]?.[l]?.[lang] || ""; return <option key={l} value={l}>{lang === 'sv' ? `NivÃ¥ ${l}` : `Level ${l}`} â€” {desc}</option>; })}
                                    </select>
                                    <div className="absolute left-4 top-1/2 -translate-y-1/2 text-indigo-500 font-bold text-xs uppercase tracking-wide">{ui.level}</div>
                                    <div className="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"><svg className="fill-current h-4 w-4" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg></div>
                                </div>
                            </div>
                            <main className="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100 relative">
                                {loading ? (
                                    <div className="p-20 text-center flex flex-col items-center gap-4"><div className="w-10 h-10 border-4 border-indigo-100 border-t-indigo-600 rounded-full animate-spin"></div></div>
                                ) : question ? (
                                    <div className="p-6 sm:p-8">
                                        <div className="mb-8 flex justify-center bg-gray-50 rounded-xl p-6 min-h-[200px] items-center border border-gray-100 relative">
                                            {question.renderData.graph ? (<GraphCanvas data={question.renderData.graph} />) : 
                                             question.renderData.geometry ? (<GeometryVisual data={question.renderData.geometry} />) : 
                                             (<div className="flex flex-col items-center justify-center w-full">
                                                {question.renderData.latex && <div className="text-2xl sm:text-4xl font-mono text-gray-800 my-4 text-center"><MathText text={`$${question.renderData.latex}$`} large={true} /></div>}
                                              </div>)}
                                        </div>
                                        <div className="mb-10 text-center"><h2 className="text-xl font-medium text-gray-700 leading-relaxed"><MathText text={question.renderData.description} /></h2></div>
                                        <form onSubmit={handleSubmit} className="max-w-md mx-auto space-y-4">
                                            <div className="relative">
                                                <input type="text" value={input} onChange={(e) => setInput(e.target.value)} className={`w-full p-4 text-center text-xl font-medium border-2 rounded-xl outline-none transition-all shadow-sm ${feedback === 'correct' ? 'border-green-500 bg-green-50 text-green-700' : feedback === 'incorrect' ? 'border-red-500 bg-red-50 text-red-700' : 'border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50'}`} placeholder={question.renderData.answerType === 'scale' ? "1:X" : ui.placeholder} autoFocus disabled={feedback === 'correct'} />
                                            </div>
                                            <button type="submit" className={`w-full py-4 rounded-xl font-bold text-lg text-white shadow-md transition-all active:scale-95 ${feedback === 'correct' ? 'bg-green-500 shadow-green-200 cursor-default' : 'bg-indigo-600 hover:bg-indigo-700 shadow-indigo-200 hover:shadow-lg'}`}>{feedback === 'correct' ? ui.correct : feedback === 'incorrect' ? ui.incorrect : ui.submit}</button>
                                        </form>
                                        <div className="mt-8 text-center">
                                            <button type="button" onClick={() => setCluesVisible(!cluesVisible)} className="text-sm font-semibold text-gray-400 hover:text-indigo-600 transition-colors flex items-center justify-center gap-2 mx-auto"><span>{cluesVisible ? 'ðŸš«' : 'ðŸ’¡'}</span>{cluesVisible ? ui.hideHelp : ui.help}</button>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="p-12 text-center text-red-400"><p>{ui.error}</p><button onClick={() => fetchQuestion()} className="text-indigo-600 underline text-sm mt-2">Retry</button></div>
                                )}
                            </main>
                        </div>
                        {question && question.clues && <CluePanel clues={question.clues} isVisible={cluesVisible} ui={ui} />}
                    </div>
                    <footer className="mt-auto py-8 text-gray-400 text-xs text-center border-t border-gray-200">Anpassa Math Platform â€¢ v2.3</footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>